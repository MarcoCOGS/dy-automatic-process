generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             String       @id @default(uuid())
  email          String       @unique
  username       String       @unique
  password       String
  phone          String?
  organizationId String
  organization   Organization @relation(fields: [organizationId], references: [id])
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  @@map("users")
}

model Organization {
  id        String    @id @default(uuid())
  name      String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  users     User[]
  invoices  Invoice[]

  @@map("organizations")
}

model Invoice {
  id                      String        @id @default(uuid())
  groupId                 String?
  state                   String
  comment                 String?
  page                    Int?
  totalPage               Int?
  invoiceCode             String        @unique
  invoiceInfo             Json?
  supplierInfo            Json?
  transactionInfo         Json?
  legalRepresentativeInfo Json?
  organizationId          String
  organization            Organization  @relation(fields: [organizationId], references: [id])
  items                   InvoiceItem[]
  createdAt               DateTime      @default(now())
  updatedAt               DateTime      @updatedAt

  @@index([organizationId])
  @@index([groupId])
  @@index([state])
  @@map("invoices")
}

model InvoiceItem {
  id                   String   @id @default(uuid())
  invoiceId            String
  invoice              Invoice  @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  itemCode             String?
  description          String?
  quantity             Int?
  unitType             String?
  unitPrice            Decimal? @db.Decimal(18, 2)
  totalPrice           Decimal? @db.Decimal(18, 2)
  taxRate              Decimal? @db.Decimal(5, 4)
  taxAmount            Decimal? @db.Decimal(18, 2)
  discountAmount       Decimal? @db.Decimal(18, 2)
  brand                String?
  model                String?
  commercialName       String?
  material             String?
  mainUse              String?
  countryOfOrigin      String?
  countryOfAcquisition String?
  condition            String?
  referenceCountry     String?
  suggestedHsCode      String?
  code                 String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt

  @@index([invoiceId])
  @@map("invoice_items")
}
